<nav class="navbar navbar-top navbar-expand navbar-dark bg-primary border-bottom">
  <div class="container-fluid">
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <!-- Search form -->
      <form class="navbar-search navbar-search-light form-inline mr-sm-3" id="navbar-search-main">
        <div class="form-group mb-0">
          <div class="input-group input-group-alternative input-group-merge">
            <div class="input-group-prepend">
              <span class="input-group-text"><i class="fas fa-search"></i></span>
            </div>
            <input class="form-control" placeholder="Search" type="text">
          </div>
        </div>
        <button type="button" class="close" data-action="search-close" data-target="#navbar-search-main" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </form>
      <!-- Navbar links -->
      <ul class="navbar-nav align-items-center  ml-md-auto ">
        <li class="nav-item d-xl-none" id="toggle-sidebar">
          <!-- Sidenav toggler -->
          <div data-toggle="tooltip" title="Toggle Sidenav" class="pr-3 sidenav-toggler sidenav-toggler-dark" data-action="sidenav-pin" data-target="#sidenav-main">
            <div class="sidenav-toggler-inner">
              <i class="sidenav-toggler-line"></i>
              <i class="sidenav-toggler-line"></i>
              <i class="sidenav-toggler-line"></i>
            </div>
          </div>
        </li>

        <li class="nav-item d-sm-none" id="open-search">
          <a class="nav-link" href="#" data-action="search-show" data-toggle="tooltip" title="Open Search" data-target="#navbar-search-main">
            <i class="ni ni-zoom-split-in"></i>
          </a>
        </li>

        <li class="nav-item dropdown" id="notification-dropdown">
          <a class="nav-link" id="notif-btn" href="#" role="button" data-toggle="dropdown" title="Notifications" aria-haspopup="true" aria-expanded="false">
            <i class="ni ni-bell-55"></i>
          </a>
  
          <div class="dropdown-menu dropdown-menu-xl dropdown-menu-right py-0 overflow-hidden" id="notification-list">
            <div class="px-3 py-3">
              <h6 class="text-sm text-muted m-0">You have <strong class="text-primary" id="notification-count">0</strong> notifications.</h6>
            </div>
            <div class="list-group list-group-flush" id="notification-items">
              <!-- Las notificaciones se cargarán aquí -->
            </div>
            <a href="#!" class="dropdown-item text-center text-primary font-weight-bold py-3" id="view-all">View all</a>
          </div>
        </li>

        <li class="nav-item dropdown" id="more-actions-dropdown">
          <a class="nav-link" id="more-actions-btn"  href="#" role="button" data-toggle="dropdown" title="More Actions" aria-haspopup="true" aria-expanded="false">
            <i class="ni ni-ungroup"></i>
          </a>
          <div class="dropdown-menu dropdown-menu-lg dropdown-menu-dark bg-default  dropdown-menu-right ">
            <div class="row shortcuts px-4">
              <a href="#!" class="col-4 shortcut-item">
                <span class="shortcut-media avatar rounded-circle bg-gradient-red">
                  <i class="ni ni-calendar-grid-58"></i>
                </span>
                <small>Calendar</small>
              </a>
              <a href="#!" class="col-4 shortcut-item">
                <span class="shortcut-media avatar rounded-circle bg-gradient-orange">
                  <i class="ni ni-email-83"></i>
                </span>
                <small>Email</small>
              </a>
              <a href="#!" class="col-4 shortcut-item">
                <span class="shortcut-media avatar rounded-circle bg-gradient-info">
                  <i class="ni ni-credit-card"></i>
                </span>
                <small>Payments</small>
              </a>
              <a href="#!" class="col-4 shortcut-item">
                <span class="shortcut-media avatar rounded-circle bg-gradient-green">
                  <i class="ni ni-books"></i>
                </span>
                <small>Reports</small>
              </a>
              <a href="#!" class="col-4 shortcut-item">
                <span class="shortcut-media avatar rounded-circle bg-gradient-purple">
                  <i class="ni ni-pin-3"></i>
                </span>
                <small>Maps</small>
              </a>
              <a href="#!" class="col-4 shortcut-item">
                <span class="shortcut-media avatar rounded-circle bg-gradient-yellow">
                  <i class="ni ni-basket"></i>
                </span>
                <small>Shop</small>
              </a>
            </div>
          </div>
        </li>
      </ul>
      <ul class="navbar-nav align-items-center  ml-auto ml-md-0 ">

        <li class="nav-item" id="wallet-btn">
          
          <button id="connect-wallet" class="btn btn-sm btn-dark" data-toggle="tooltip" title="Connect Wallet">

            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
              <g fill="none">
                <path fill="#f5841f" d="m20.476 11.987l.899-1.032l-.391-.28l.625-.562l-.482-.357l.625-.459l-.403-.306l.651-3.11L21.01 3m0 0l-6.36 2.307h-5.3L2.99 3L2 5.881l.664 3.11l-.416.306l.638.46l-.482.356l.625.561l-.39.28l.898 1.033l-1.368 4.13l1.264 4.22l4.443-1.198l.86.688L10.496 21h3.009l1.759-1.173l.86-.688l4.456 1.198l1.277-4.22l-1.381-4.13" />
                <path fill="#e27625" d="m21.01 3l-7.805 5.622l1.447-3.315zM2.99 3l7.74 5.673l-1.381-3.366zm15.219 13.041l-2.085 3.085l4.456 1.198l1.277-4.22zm-16.039.064l1.263 4.22l4.443-1.199l-2.071-3.085z" />
                <path fill="#e27625" d="m7.642 10.814l-1.238 1.823l4.404.192l-.143-4.615zm8.729 0l-3.075-2.651l-.09 4.666l4.403-.192zm-8.495 8.312l2.671-1.25l-2.306-1.733zm5.59-1.249l2.658 1.25l-.365-2.984z" />
                <path fill="#d7c1b3" d="m16.124 19.126l-2.658-1.25l.221 1.683l-.026.714zm-8.248 0l2.476 1.147l-.013-.713l.208-1.683z" />
                <path fill="#2f343b" d="m10.39 15.021l-2.201-.624l1.563-.702zm3.22 0l.65-1.326l1.564.702z" />
                <path fill="#cc6228" d="m7.876 19.126l.391-3.085l-2.462.064zm7.87-3.085l.378 3.085l2.085-3.021zm1.864-3.404l-4.405.192l.404 2.192l.652-1.326l1.563.702zm-9.421 1.76l1.563-.702l.639 1.326l.417-2.192l-4.404-.192z" />
                <path fill="#e27625" d="m6.404 12.637l1.837 3.506l-.052-1.746zm9.42 1.76l-.065 1.746l1.85-3.506zm-5.016-1.568l-.417 2.192l.521 2.6l.117-3.416zm2.397 0l-.221 1.364l.104 3.429l.521-2.6z" />
                <path fill="#f5841f" d="m13.61 15.021l-.522 2.6l.378.256l2.293-1.734l.065-1.746zm-5.421-.624l.052 1.746l2.306 1.734l.365-.255l-.521-2.6z" />
                <path fill="#c0ad9e" d="m13.661 20.273l.026-.713l-.208-.166H10.52l-.182.166l.013.713l-2.476-1.147l.86.688L10.496 21h3.009l1.759-1.186l.86-.688z" />
                <path fill="#2f343b" d="m13.466 17.877l-.378-.255h-2.176l-.365.255l-.208 1.683l.182-.166h2.958l.208.166z" />
                <path fill="#763e1a" d="M21.349 8.992L22 5.88L21.01 3l-7.544 5.43l2.905 2.384l4.105 1.173l.899-1.032l-.391-.28l.625-.549l-.482-.37l.625-.459zM2 5.881l.664 3.11l-.416.306l.625.472l-.482.357l.625.548l-.39.28l.911 1.033l4.105-1.173l2.905-2.383L2.99 3z" />
                <path fill="#f5841f" d="m20.476 11.987l-4.105-1.173l1.238 1.823l-1.85 3.506l2.45-.038h3.648zM7.642 10.814l-4.105 1.173l-1.368 4.118h3.636l2.436.038l-1.837-3.506zm5.563 2.015l.26-4.398l1.187-3.124H9.349l1.198 3.124l.26 4.398l.105 1.376v3.417h2.176l.013-3.417z" />
              </g>
            </svg>
            Conectar Wallet</button>
        </li>

        <li class="nav-item dropdown" id="profile-dropdown">
          <a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="User Actions">
            <div class="media align-items-center">
              <span class="avatar avatar-sm rounded-circle">
                <img alt="Image placeholder" src="/static/assets/img/theme/team-4.jpg">
              </span>
              <div class="media-body  ml-2  d-none d-lg-block">
                <span class="mb-0 text-sm  font-weight-bold">
                  {{ request.user.username }}
                </span>
              </div>
            </div>
          </a>
          <div class="dropdown-menu  dropdown-menu-right ">
            <div class="dropdown-header noti-title">
              <h6 class="text-overflow m-0">Welcome!</h6>
            </div>
            <a href="/profile.html" class="dropdown-item">
              <i class="ni ni-single-02"></i>
              <span>My profile</span>
            </a>
            <a target="_blank" href="http://appseed.us/support" class="dropdown-item">
              <i class="ni ni-support-16"></i>
              <span>Support</span>
            </a>
            <div class="dropdown-divider"></div>
            <a href="{% url 'logout' %}" class="dropdown-item">
              <i class="ni ni-user-run text-red"></i>
              <span>Logout</span>
            </a>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>


{% block javascripts %}
  <script src="/static/assets/js/components/wallet/metamask.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Cargar notificaciones al abrir el dropdown
        let notificationsLoaded = false;
        document.getElementById('notif-btn').addEventListener('click', function() {
          if (!notificationsLoaded) {
            fetchNotifications();
            notificationsLoaded = true;
          }
        });
      });

      function fetchNotifications() {
        fetch('get_notifications_template/')
          .then(response => response.json())
          .then(data => {
            const notificationItems = document.getElementById('notification-items');
            const notificationCount = document.getElementById('notification-count');

            notificationItems.innerHTML = '';  // Limpiar items existentes
            notificationCount.textContent = data.notifications.length;

            data.notifications.forEach(html => {
              notificationItems.insertAdjacentHTML('beforeend', html);
            });
          })
          .catch(error => console.error('Error fetching notifications:', error));
      }
    
  </script>


{% endblock javascripts %}